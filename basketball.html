<!DOCTYPE html>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basketball Scoreboard</title>
<link href="https://fonts.cdnfonts.com/css/digital-7-mono" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@700;900&display=swap" rel="stylesheet">
<link rel="icon" href="data:image/svg+xml,%3Csvg version='1.0' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='256px' height='256px' viewBox='0 0 64 64' xml:space='preserve'%3E%3Crect width='100%25' height='100%25' fill='%23000'/%3E%3Cg%3E%3Cpath fill='%23F76' d='M20.161,2.273C16.233,3.835,12.553,6.2,9.375,9.378C9.19,9.562,9.018,9.755,8.838,9.942c1.386,3.831,3.126,7.562,5.242,11.133C18.139,15.485,20.168,8.879,20.161,2.273z'/%3E%3Cpath fill='%23F76' d='M63.824,28.682c-9.751-1.521-20.067,1.469-27.58,8.981c-1.202,1.202-2.287,2.479-3.258,3.812c7.363,5.18,15.545,8.678,24.021,10.495C62.398,45.233,64.671,36.827,63.824,28.682z'/%3E%3Cpath fill='%23F76' d='M27.05,63.616c9.75,1.519,20.067-1.471,27.58-8.983c0.308-0.308,0.602-0.624,0.894-0.94c-8.344-1.927-16.387-5.451-23.659-10.562C27.924,49.32,26.316,56.563,27.05,63.616z'/%3E%3Cpath fill='%23F76' d='M12.771,22.754c-2.172-3.571-3.98-7.297-5.435-11.13c-4.895,5.909-7.34,13.163-7.332,20.416c3.926-1.562,7.607-3.928,10.785-7.105C11.491,24.232,12.147,23.503,12.771,22.754z'/%3E%3Cpath fill='%23F76' d='M13.881,24.53c-0.535,0.62-1.09,1.231-1.678,1.819c-3.554,3.553-7.701,6.146-12.121,7.798c0.497,7.462,3.59,14.782,9.293,20.485c0.027,0.028,0.057,0.054,0.085,0.082c2.091-7.833,5.595-15.364,10.528-22.188C17.73,29.981,15.691,27.309,13.881,24.53z'/%3E%3Cpath fill='%23F76' d='M30.236,41.961c-2.588-1.935-5.074-4.067-7.427-6.42c-0.493-0.493-0.958-1.003-1.433-1.507c-4.874,6.828-8.298,14.369-10.258,22.207c4.102,3.541,8.884,5.869,13.886,6.984C24.372,55.889,26.117,48.385,30.236,41.961z'/%3E%3Cpath fill='%23F76' d='M22.583,32.401c0.54,0.579,1.076,1.161,1.641,1.726c2.262,2.262,4.653,4.313,7.14,6.18c1.033-1.42,2.187-2.778,3.467-4.058c7.829-7.829,18.525-11.037,28.708-9.635c-1.062-6.245-3.979-12.235-8.761-17.08c-9.619,3.111-18.671,8.468-26.311,16.107C26.321,27.787,24.371,30.052,22.583,32.401z'/%3E%3Cpath fill='%23F76' d='M15.215,22.892c1.773,2.78,3.774,5.456,6.007,8.002c1.78-2.312,3.711-4.546,5.831-6.666c7.594-7.595,16.541-13.007,26.063-16.257c-8.688-7.646-20.523-9.78-30.973-6.405C22.307,9.073,19.998,16.62,15.215,22.892z'/%3E%3C/g%3E%3C/svg%3E">
<style>
:root {
	--width: 1920px;
	--height: 1080px;
	--bg: #000;
	--bg-input: #333;
	--dred: #800;
	--dgreen: #080;
	--led-red: #f00;
	--led-green: #0f0;
	--led-white: #fff;
	--highlight: #ff8;
	--btn-face: linear-gradient(180deg, #444 0%, #222 100%);
	--btn-border: #555;
	--fsOpacity: 0.4;
}

body {
	background-color: var(--bg);
	margin: 0;
	padding: 0;
	display: flex;
	justify-content: center;
	align-items: center;
	height: 100vh;
	width: 100vw;
	font-family: 'Roboto', sans-serif;
	user-select: none;
	overflow: hidden;
}

input::placeholder {
	color: var(--btn-border);
}
input:hover::placeholder {
	color: var(--highlight);
}

/* --- Full Screen Upper Right Corner--- */
#btn-fullscreen {
	z-index: 10;
	position: fixed;
	top: 0;
	right: 0;
	background: var(--bg-input);
	cursor: pointer;
	opacity: var(--fsOpacity);
	transition: opacity 0.3s;
}
#btn-fullscreen:hover {
	opacity: 1;
}

/* --- Time Setting Popup --- */
#popup {
	display: none;
	z-index: 5;
	position: fixed;
	top: 50%;
	left: 50%;
	transform: translate(-50%, -50%) scale(2);
	margin-top: -40px;
	color: var(--led-white);
	background: var(--btn-border);
	padding: 0 20px 20px;
	border: 0;
	box-shadow: 0 14px 18px rgba(0,0,0,0.5);
}

#scalable-container {
	display: flex;
	justify-content: center;
	align-items: center;
	transform-origin: center center;
	width: var(--width);
	height: var(--height);
}
.full-layout {
	display: flex;
	align-items: flex-start;
	gap: 20px;
	min-width: max-content;
}

/* --- Player Stats Panel --- */
.player-stats {
	border: 2px solid var(--bg-input);
	font-size: 40px;
	margin-top: -25px;
	padding: 10px;
	width: 220px;
	color: white;
	border-radius: 8px;
}
.stats-header {
	display: flex;
	justify-content: space-between;
	font-weight: 600;
	border-bottom: 2px solid var(--bg-input);
	padding-bottom: 10px;
	margin-bottom: 10px;
	text-align: center;
}
.col-num {
	width: 33%;
	color: var(--led-white);
}
.col-foul {
	width: 33%;
	color: var(--led-red);
}
.col-pts {
	width: 33%;
	color: var(--led-green);
}
.player-row {
	display: flex;
	justify-content: space-between;
	margin-bottom: 5px;
	font-weight: bold;
}
.stat-input {
	width: 33%;
	background: transparent;
	border: none;
	text-align: center;
	font-size: inherit;
	font-weight: inherit;
	outline: none;
	padding: 2px 0;
}
.stat-input:focus {
	background-color: var(--bg-input);
	color: var(--led-white) !important;
}
.inp-num {
	color: var(--led-white);
}
.inp-foul {
	color: var(--led-red);
}
.inp-pts {
	color: var(--led-green);
}

/* --- Main Scoreboard --- */
.scoreboard {
	width: 1300px;
	max-width: 100%;
	background-color: var(--bg);
	position: relative;
	color: var(--led-white);
}

/* --- Period Section --- */
.top-bar {
	display: flex;
	justify-content: center;
	margin-bottom: 5px;
	font-size: 24px;
	font-weight: 600;
}
.period-box {
	display: flex;
	transform: scale(1.5);
}
.p-label {
	background: var(--bg-input);
	border: 1px solid var(--bg-input);
	padding: 5px 15px;
	display: flex;
	align-items: center;
}
.p-num {
	width: 50px;
	border: 2px solid var(--bg-input);
	display: flex;
	justify-content: center;
	align-items: center;
	padding: 5px 0;
	color: var(--btn-border);
	transition: all 0.2s;
	cursor: pointer;
}
.p-num:hover {
	background-color: var(--led-red);
	color: var(--bg);
}
.p-active {
	background-color: var(--led-red);
	color: var(--led-white);
	font-weight: 900;
}

/* --- Main Clock --- */
.main-clock-area {
	display: flex;
	justify-content: center;
	align-items: center;
	margin-top: -30px;
}
.digital-font {
	font-family: 'Digital-7 Mono', monospace;
	line-height: 1;
}
.main-time {
	font-size: 320px;
	color: var(--led-white);
	text-shadow: 0 0 0.05em rgba(255, 255, 255, 0.5);
	letter-spacing: 0;
	margin: 0 20px;
	text-align: center;
	line-height: 0.85;
	cursor: pointer;
	transition: color 0.2s;
}
.main-time:hover {
	color: var(--highlight);
	text-shadow: 0 0 0.05em rgba(255, 255, 200, 0.8);
}

/* --- Side Buttons --- */
.sport-btn {
	background: var(--btn-face);
	border: 2px solid var(--btn-border);
	border-radius: 6px;
	box-shadow: 0 4px 0 var(--bg);
	cursor: pointer;
	display: flex;
	justify-content: center;
	align-items: center;
	transition: all 0.1s;
	position: relative;
}
.sport-btn:hover {
	background: var(--bg);
}
.sport-btn:active {
	background: var(--bg);
}
.up {
	border-left: 12px solid transparent;
	border-right: 12px solid transparent;
	border-bottom: 18px solid var(--led-white);
	filter: drop-shadow(0 0 2px var(--led-white));
}
.down {
	border-left: 12px solid transparent;
	border-right: 12px solid transparent;
	border-top: 18px solid var(--led-white);
	filter: drop-shadow(0 0 2px var(--led-white));
}
.time-controls {
	display: flex;
	flex-direction: column;
	gap: 20px;
	align-items: center;
	margin-top: 60px;
}
.btn-time {
	width: 50px;
	height: 40px;
}
.time-label {
	font-size: 30px;
	color: var(--led-white);
	margin-top: 5px;
	text-transform: uppercase;
	font-weight: 600;
}

/* Start/Stop */
.start-btn-container {
	text-align: center;
	margin-top: 30px;
	position: relative;
}
.btn-start {
	width: 140px;
	background: linear-gradient(180deg, #2f2 0%, #2c2 100%);
	color: var(--led-white);
	border: 2px solid #8f8;
	margin-top: 5px;
	padding: 15px;
	font-weight: 900;
	font-size: 30px;
	cursor: pointer;
	text-transform: uppercase;
	border-radius: 6px;
	transition: 0.1s;
}
.btn-start:hover {
	color: var(--bg);}
.btn-start:active {
	color: var(--bg);
}
.btn-stop {
	width: 140px;
	background: linear-gradient(180deg, #f22 0%, #c22 100%);
	border-color: #f88;
}

/* --- Game Grid --- */
.game-grid {
	display: flex;
	justify-content: center;
	align-items: flex-start;
	margin-top: 10px;
	margin-bottom: 10px;
	gap: 20px;
}
.team-column {
	text-align: center;
	width: 350px;
	display: flex;
	flex-direction: column;
	align-items: center;
}
.team-name {
	font-size: 60px;
	font-weight: 900;
	text-transform: uppercase;
	margin-top: -10px;
	margin-bottom: 15px;
	background: transparent;
	border: none;
	color: white;
	text-align: center;
	width: 100%;
	transition: 0.3s;
	cursor: text;
	outline: none;
	padding: 0;
}
.team-name:hover {
	color: var(--highlight);
}
.team-name:focus {
	background-color: var(--bg-input);
	color: var(--led-white);
}
.score-display {
	font-size: 280px;
	color: var(--led-green);
	text-shadow: 0 0 20px rgba(0, 255, 0, 0.7);
	margin: -10px 0;
	line-height: 0.5;
	padding-bottom: 70px;
	border: 4px var(--bg-input) solid;
	border-radius: 8px;
}
.score-controls {
	transform: scale(1.1);
	display: flex;
	justify-content: center;
	gap: 15px;
	margin-top: 20px;
}
.btn-score {
	width: 90px;
	height: 55px;
}
.tri-up {
	border-left: 12px solid transparent;
	border-right: 12px solid transparent;
	border-bottom: 18px solid var(--led-green);
	filter: drop-shadow(0 0 2px var(--led-green));
}
.tri-down {
	border-left: 12px solid transparent;
	border-right: 12px solid transparent;
	border-top: 18px solid var(--led-red);
	filter: drop-shadow(0 0 2px var(--led-red));
}
.score {
	color: var(--led-green);
	font-size: 40px;
	font-weight: 600;
}

/* --- Lower Center --- */
.center-column {
	display: flex;
	flex-direction: column;
	align-items: center;
	width: 180px;
	margin-top: -20px;
	position: relative;
}
.label-shot {
	font-size: 40px;
	font-weight: 900;
	margin: 20px 0 -30px;
	white-space: nowrap;
}
.shot-clock {
	font-size: 160px;
	color: var(--led-white);
	margin: 5px;
	width: 100%;
	text-align: center;
	line-height: 0.9;
}
.shot-buttons {
	display: flex;
	gap: 10px;
	justify-content: center;
	width: 100%;
	margin-top: 20px;
}
.btn-shot {
	background: var(--bg-input);
	color: var(--led-white);
	border: 1px solid var(--btn-border);
	padding: 5px 15px;
	font-size: 30px;
	cursor: pointer;
	border-radius: 4px;
	box-shadow: 0 2px 0 var(--bg);
	margin-top: 10px;
}
.btn-shot:hover {
	background: var(--bg);
}
.btn-shot:active {
	background: var(--bg);
}

/* --- Bottom Section --- */
.bottom-section {
	display: flex;
	justify-content: center;
	align-items: flex-end;
	margin-top: 0px;
	position: relative;
	padding: 0 10px;
	gap: 190px;
}
.bonus-section {
	display: flex;
	align-items: flex-end;
	gap: 10px;
}
.bonus-right {
	flex-direction: row-reverse;
}
.bonus-bar {
	border: 3px solid var(--bg-input);
	color: var(--bg-input);
	border-radius: 6px;
	font-size: 25px;
	font-weight: 600;
	display: flex;
	flex-direction: column;
	align-items: center;
	width: 40px;
	height: 120px;
	justify-content: center;
	background: var(--bg);
	transition: 0.3s;
}
.bonus-bar:hover {
	border: 3px solid var(--btn-border);
	color: var(--btn-border);
}
.bonus-active {
	background-color: var(--led-red);
	border-color: var(--led-red);
	color: var(--led-white);
	box-shadow: 0 0 15px var(--led-red);
}
.bonus-active:hover {
	background-color: var(--dred);
	border-color: var(--dred);
	color: var(--led-white);
	box-shadow: 0 0 15px var(--dred);
}
.bonus-text span {
	display: block;
	writing-mode: vertical-rl;
	text-orientation: upright;
	letter-spacing: -2px;
}

.stats-group {
	display: flex;
	flex-direction: column;
	gap: 10px;
	transform: scale(1.3);
	margin-bottom: 5px;
}
.stat-row {
	display: flex;
	align-items: center;
	gap: 10px;
	cursor: pointer;
}
.stat-label {
	font-weight: 600;
	font-size: 24px;
	width: 40px;
}
.stat-label.red {
	color: var(--led-red);
}
.stat-label:hover.red {
	color: var(--dred);
}
.stat-label.green {
	color: var(--led-green);
}
.stat-label:hover.green {
	color: var(--dgreen);
}
.left-stats {
	transform-origin: bottom left;
	margin-left: 10px;
}
.left-stats .stat-label {
	margin-left: -10px;
	text-align: right;
}
.right-stats {
	transform-origin: bottom right;
	margin-right: 5px;
}
.right-stats .stat-label {
	text-align: right;
}
.dots-container {
	display: flex;
	gap: 6px;
	width: 134px;
}
.left-stats .dots-container {
	flex-direction: row-reverse;
}
.right-stats .dots-container {
	justify-content: flex-start;
}
.dot {
	width: 22px;
	height: 22px;
	border-radius: 50%;
	background-color: var(--bg-input);
	transition: 0.2s;
	display: inline-block;
}
.dot:hover {
	background-color: var(--btn-border);
}
.dot.red-on {
	background-color: var(--led-red);
	box-shadow: 0 0 8px var(--led-red);
}
.dot:hover.red-on {
	background-color: var(--dred);
}
.dot.green-on {
	background-color: var(--led-green);
	box-shadow: 0 0 8px var(--led-green);
}
.dot:hover.green-on {
	background-color: var(--dgreen);
}

.pos-container {
	display: flex;
	flex-direction: column;
	align-items: center;
	position: relative;
	left: auto;
	transform: scale(2.5);
	bottom: 0;
	margin-bottom: 5px;
	margin-left: 0px;
	margin-right: 0px;
	cursor: pointer;
	width: 80px;
	padding-bottom: 30px;
}
.pos-label {
	font-size: 20px;
	font-weight: 600;
	margin-bottom: 2px;
}
.pos-arrows {
	display: flex;
	flex-direction: row;
	gap: 10px;
}
.arrow-left {
	border-top: 15px solid transparent;
	border-bottom: 15px solid transparent;
	border-right: 40px solid var(--bg-input);
}
.arrow-left:hover {
	border-right: 40px solid var(--btn-border);
}
.arrow-right {
	border-top: 15px solid transparent;
	border-bottom: 15px solid transparent;
	border-left: 40px solid var(--bg-input);
}
.arrow-right:hover {
	border-left: 40px solid var(--btn-border);
}
.arrow-left.active {
	border-right-color: var(--led-red);
	filter: drop-shadow(0 0 10px var(--led-red));
}
.arrow-left:hover.active {
	border-right-color: var(--dred);
}
.arrow-right.active {
	border-left-color: var(--led-red);
	filter: drop-shadow(0 0 10px var(--led-red));
}
.arrow-right:hover.active {
	border-left-color: var(--dred);
}
</style>
<button id="btn-fullscreen" onclick="toggleFullScreen()"></button>
<div id="scalable-container">
	<div id="popup">
		<div>
			<h5>Set time: &nbsp; <u>Minutes</u> &nbsp; or &nbsp; <u>Minutes:Seconds</u></h5>
			<input type="text" id="popup-input">
			<button type="submit" id="popup-ok">Set</button>
			<button type="button" id="popup-cancel">Cancel</button>
		</div>
	</div>
	<div class="full-layout">
		<div class="player-stats">
			<div class="stats-header">
				<span class="col-num">#</span> <span class="col-foul">F</span> <span class="col-pts">P</span>
			</div>
			<div id="left-players"></div>
		</div>
		<div class="scoreboard">
			<div class="top-bar">
				<div class="period-box">
					<div class="p-label">PERIOD</div>
					<div class="p-num" id="p1" onclick="setPeriod(1)">1</div>
					<div class="p-num" id="p2" onclick="setPeriod(2)">2</div>
					<div class="p-num" id="p3" onclick="setPeriod(3)">3</div>
					<div class="p-num" id="p4" onclick="setPeriod(4)">4</div>
				</div>
			</div>
			<div class="main-clock-area">
				<div class="time-controls">
					<div class="sport-btn btn-time" onclick="adjustMainTime(60)"><div class="up"></div></div>
					<div class="sport-btn btn-time" onclick="adjustMainTime(-60)"><div class="down"></div></div>
					<div class="time-label">MIN</div>
				</div>
				<div class="main-time digital-font" id="main-timer" onclick="setCustomTime()">00:00</div>
				<div class="time-controls">
					<div class="sport-btn btn-time" onclick="adjustMainTime(1)"><div class="up"></div></div>
					<div class="sport-btn btn-time" onclick="adjustMainTime(-1)"><div class="down"></div></div>
					<div class="time-label">SEC</div>
				</div>
			</div>
			<div class="start-btn-container">
				<button class="btn-start" id="btn-start" onclick="toggleTimer()">START</button>
			</div>
			<div class="game-grid">
				<div class="team-column">
					<input type="text" class="team-name" value="" placeholder="HOME" onfocus="this.select()">
					<div class="score-display digital-font" id="score-home">000</div>
					<div class="score-controls">
						<div class="sport-btn btn-time score" onclick="updateScore('home', 3)">3</div>
						<div class="sport-btn btn-time score" onclick="updateScore('home', 2)">2</div>
						<div class="sport-btn btn-score" onclick="updateScore('home', 1)"><div class="tri-up"></div></div>
						<div class="sport-btn btn-score" onclick="updateScore('home', -1)"><div class="tri-down"></div></div>
					</div>
				</div>
				<div class="center-column">
					<div class="shot-buttons">
						<button class="btn-shot" onclick="resetShotClock(24)">24</button>
						<button class="btn-shot" onclick="resetShotClock(14)">14</button>
					</div>
					<div class="label-shot">SHOT</div>
					<div class="shot-clock digital-font" id="shot-timer">24</div>
				</div>
				<div class="team-column">
					<input type="text" class="team-name" value="" placeholder="GUEST" onfocus="this.select()">
					<div class="score-display digital-font" id="score-guest">000</div>
					<div class="score-controls">
						<div class="sport-btn btn-score" onclick="updateScore('guest', -1)"><div class="tri-down"></div></div>
						<div class="sport-btn btn-score" onclick="updateScore('guest', 1)"><div class="tri-up"></div></div>
						<div class="sport-btn btn-time score" onclick="updateScore('guest', 2)">2</div>
						<div class="sport-btn btn-time score" onclick="updateScore('guest', 3)">3</div>
					</div>
				</div>
			</div>
			<div class="bottom-section">
				<div class="bonus-section">
					<div class="bonus-bar" id="bonus-home" onclick="addFoul('home')">
						<div class="bonus-text"><span>B</span><span>O</span><span>N</span><span>U</span><span>S</span></div>
					</div>
					<div class="stats-group left-stats">
						<div class="stat-row" onclick="addFoul('home')">
							<div class="dots-container" id="home-tf">
								<div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div>
							</div>
							<div class="stat-label red">TF</div>
						</div>
						<div class="stat-row" onclick="useTimeout('home')">
							<div class="dots-container" id="home-to">
								<div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div>
							</div>
							<div class="stat-label green">TO</div>
						</div>
					</div>
				</div>
				<div class="pos-container" onclick="togglePos()">
					<div class="pos-label">POS</div>
					<div class="pos-arrows">
						<div class="arrow-left" id="pos-left"></div>
						<div class="arrow-right active" id="pos-right"></div>
					</div>
				</div>
				<div class="bonus-section bonus-right">
					<div class="bonus-bar" id="bonus-guest" onclick="addFoul('guest')">
						<div class="bonus-text"><span>B</span><span>O</span><span>N</span><span>U</span><span>S</span></div>
					</div>
					<div class="stats-group right-stats">
						<div class="stat-row" onclick="addFoul('guest')">
							<div class="stat-label red">TF</div>
							<div class="dots-container" id="guest-tf">
								<div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div>
							</div>
						</div>
						<div class="stat-row" onclick="useTimeout('guest')">
							<div class="stat-label green">TO</div>
							<div class="dots-container" id="guest-to">
								<div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="player-stats">
			<div class="stats-header">
				<span class="col-num">#</span> <span class="col-foul">F</span> <span class="col-pts">P</span>
			</div>
			<div id="right-players"></div>
		</div>
	</div>
</div>
<script>
// --- Full Screen Scaling Logic ---
const fullScreen = '<svg height="40px" width="40px" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512"  xml:space="preserve"><style type="text/css">.st0{fill:#fff;}</style><g><polygon class="st0" points="345.495,0 394.507,49.023 287.923,155.607 356.384,224.086 462.987,117.493 511.991,166.515 511.991,0"/><polygon class="st0" points="155.615,287.914 49.022,394.507 0.009,345.494 0.009,512 166.515,512 117.493,462.978 224.087,356.375"/><polygon class="st0" points="356.384,287.914 287.923,356.375 394.507,462.978 345.495,512 511.991,512 511.991,345.485 462.977,394.507"/><polygon class="st0" points="166.505,0 0.009,0 0.009,166.506 49.022,117.493 155.615,224.086 224.087,155.607 117.501,49.023"/></g></svg>';
const noFullScreen = '<svg height="40px" width="40px" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512"  xml:space="preserve"><style type="text/css">.st0{fill:#fff;}</style><g><polygon class="st0" points="461.212,314.349 314.342,314.349 314.342,461.205 357.596,417.973 451.591,511.985 512,451.599 417.973,357.581"/><polygon class="st0" points="50.788,197.667 197.659,197.667 197.659,50.797 154.42,94.043 60.394,0.025 0,60.417 94.027,154.428"/><polygon class="st0" points="94.035,357.588 0.016,451.599 60.394,511.992 154.42,417.973 197.668,461.205 197.668,314.349 50.788,314.349"/><polygon class="st0" points="417.99,154.428 512,60.401 451.591,0.008 357.58,94.035 314.342,50.797 314.342,197.651 461.212,197.651"/></g></svg>';
function resizeBoard() {
	const container = document.getElementById('scalable-container');
	const targetWidth = 1920;
	const targetHeight = 1080;
	const windowWidth = window.innerWidth;
	const windowHeight = window.innerHeight;
	const scaleX = windowWidth / targetWidth;
	const scaleY = windowHeight / targetHeight;
	const scale = Math.min(scaleX, scaleY) * 0.95;
	container.style.transform = `scale(${scale})`;
}
window.addEventListener('resize', resizeBoard);
window.addEventListener('load', resizeBoard);
const fs = document.getElementById('btn-fullscreen');
fs.innerHTML = fullScreen;
document.addEventListener('fullscreenchange', () => {
	if (window.innerHeight !== screen.height) {
		document.documentElement.style.setProperty('--fsOpacity', 0.4);
		fs.innerHTML = fullScreen;
	}
});
function toggleFullScreen() {
	if (!document.fullscreenElement) {
		document.documentElement.requestFullscreen();
		document.documentElement.style.setProperty('--fsOpacity', 0);
		fs.innerHTML = noFullScreen;
	} else if (document.exitFullscreen) document.exitFullscreen();
}

// --- Generate Player Rows ---
function generatePlayerRows(containerId, count) {
	const container = document.getElementById(containerId);
	let html = '';
	for (let i = 0; i < count; i++) html += `
			<div class="player-row">
				<input type="text" class="stat-input inp-num" value="" placeholder="00" onfocus="this.select()">
				<input type="text" class="stat-input inp-foul" value="0" onfocus="this.select()">
				<input type="text" class="stat-input inp-pts" value="0" onfocus="this.select()">
			</div>`;
	container.innerHTML = html;
}

generatePlayerRows('left-players', 15);
generatePlayerRows('right-players', 15);

// --- Auto-clean leading zeros ---
document.addEventListener('input', function(e) {
	if (e.target.classList.contains('stat-input')) {
		let val = e.target.value;
		if (val.length > 1 && val.startsWith('0')) e.target.value = val.replace(/^0+/, '');
	}
});

// --- Directional Navigation ---
document.addEventListener('keydown', function(e) {
	// Check if user is typing in a team name or other text input
	const isInput = e.target.tagName === 'INPUT';
	if (e.target.classList.contains('team-name') && e.key === 'Enter') {
		e.preventDefault();
		e.target.blur();
		return;
	}
	if (!isInput) {
		if (e.key === '1') resetShotClock(24);
		if (e.key === '2') resetShotClock(14);
	}
	// Arrow Key Navigation logic (runs only if inside stat-input)
	if (!e.target.classList.contains('stat-input')) return;
	const currentInput = e.target;
	const currentRow = currentInput.parentElement;
	if (e.key === 'ArrowDown' || e.key === 'Enter') {
		e.preventDefault();
		const nextRow = currentRow.nextElementSibling;
		if (nextRow) {
			let selector = '';
			if (currentInput.classList.contains('inp-num')) selector = '.inp-num';
			else if (currentInput.classList.contains('inp-foul')) selector = '.inp-foul';
			else if (currentInput.classList.contains('inp-pts')) selector = '.inp-pts';
			const target = nextRow.querySelector(selector);
			if (target) {
				target.focus();
				target.select();
			}
		} else currentInput.blur();
	}
	else if (e.key === 'ArrowUp') {
		e.preventDefault();
		const prevRow = currentRow.previousElementSibling;
		if (prevRow) {
			let selector = '';
			if (currentInput.classList.contains('inp-num')) selector = '.inp-num';
			else if (currentInput.classList.contains('inp-foul')) selector = '.inp-foul';
			else if (currentInput.classList.contains('inp-pts')) selector = '.inp-pts';
			const target = prevRow.querySelector(selector);
			if (target) {
				target.focus();
				target.select();
			}
		}
	}
	else if (e.key === 'ArrowRight') {
		const nextInput = currentInput.nextElementSibling;
		if (nextInput && nextInput.classList.contains('stat-input')) {
			e.preventDefault();
			nextInput.focus();
			nextInput.select();
		}
	}
	else if (e.key === 'ArrowLeft') {
		const prevInput = currentInput.previousElementSibling;
		if (prevInput && prevInput.classList.contains('stat-input')) {
			e.preventDefault();
			prevInput.focus();
			prevInput.select();
		}
	}
});

document.addEventListener('focusout', function(e) {
	 if (e.target.classList.contains('stat-input') && !e.target.classList.contains('inp-num') && e.target.value === '') e.target.value = '0';
});

// --- State Variables ---
let mainTimeSeconds = 0 * 60 + 0;
let shotTimeSeconds = 24;
let isRunning = false;
let timerInterval = null;
let scoreHome = 0;
let scoreGuest = 0;
let period = 1;
let posLeft = false;
let foulsHome = 0;
let foulsGuest = 0;
let toHome = 0;
let toGuest = 0;
// --- Elements ---
const elMainTime = document.getElementById('main-timer');
const elShotTime = document.getElementById('shot-timer');
const elScoreHome = document.getElementById('score-home');
const elScoreGuest = document.getElementById('score-guest');
const btnStart = document.getElementById('btn-start');
// --- Timer Logic ---
function updateDisplay() {
	let m = Math.floor(mainTimeSeconds / 60);
	let s = mainTimeSeconds % 60;
	elMainTime.innerHTML = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
	elShotTime.innerText = shotTimeSeconds.toString().padStart(2, '0');
}

function toggleTimer() {
	if (isRunning) {
		clearInterval(timerInterval);
		isRunning = false;
		btnStart.innerText = "START";
		btnStart.classList.remove('btn-stop');
	} else {
		isRunning = true;
		btnStart.innerText = "STOP";
		btnStart.classList.add('btn-stop');
		timerInterval = setInterval(() => {
			if (mainTimeSeconds == 0) toggleTimer();
			else {
				mainTimeSeconds--;
				if (shotTimeSeconds > 0) shotTimeSeconds--;
			}
			updateDisplay();
		}, 1000);
	}
}

function adjustMainTime(seconds) {
	mainTimeSeconds += seconds;
	if (mainTimeSeconds < 0) mainTimeSeconds = 0;
	updateDisplay();
}

function askInput() {
	return new Promise(resolve => {
		const popup = document.getElementById("popup");
		const input = document.getElementById("popup-input");
		const okBtn = document.getElementById("popup-ok");
		const cancelBtn = document.getElementById("popup-cancel");
		const pattern = /^\d\d?(:\d\d)?$/;
		popup.style.display = "flex";
		input.value = "10:00";
		input.focus();
		input.select();
		function submit() {
			popup.style.display = "none";
			if (pattern.test(input.value)) resolve(input.value);
			else resolve(null);
			input.removeEventListener("keydown", onKeyDown);
		};
		function cancel() {
			popup.style.display = "none";
			resolve(null);
			input.removeEventListener("keydown", onKeyDown);
		};
		function onKeyDown(e) {
			if (e.key === "Enter") submit();
			else if (e.key === "Escape") cancel();
		}
		input.addEventListener("keydown", onKeyDown);
		okBtn.onclick = submit;
		cancelBtn.onclick = cancel;
	});
}

async function setCustomTime() {
	let wasRunning = isRunning;
	if (isRunning) toggleTimer();
	let input = await askInput();
	if (input) {
		let parts = input.split(':');
		if (parts.length === 2) { // M:S
			let m = parseInt(parts[0]);
			let s = parseInt(parts[1]);
			mainTimeSeconds = (m * 60) + s;
			updateDisplay();
		} else if (parts.length === 1) { // M
			let m = parseInt(parts[0]);
			mainTimeSeconds = m * 60;
			updateDisplay();
		}
	}
	if (wasRunning) toggleTimer();
}

function resetShotClock(val) {
	shotTimeSeconds = val;
	updateDisplay();
}

function updateScore(team, val) {
	if (team === 'home') {
		scoreHome += val;
		if (scoreHome < 0) {
			scoreHome = 0;
			elScoreHome.innerText = '000';
		} else elScoreHome.innerText = String(scoreHome).padStart(3, '\xA0');
	} else {
		scoreGuest += val;
		if (scoreGuest < 0) {
			scoreGuest = 0;
			elScoreGuest.innerText = '000';
		} else elScoreGuest.innerText = String(scoreGuest).padStart(3, '\xA0');
	}
}

function addFoul(team) {
	let current = (team === 'home') ? foulsHome : foulsGuest;
	current++;
	if (current > 5) current = 0;
	if (team === 'home') foulsHome = current;
	else foulsGuest = current;
	renderDots(team + '-tf', current, 5, 'red-on');
	const bonusEl = document.getElementById('bonus-' + team);
	if (current >= 5) bonusEl.classList.add('bonus-active');
	else bonusEl.classList.remove('bonus-active');
}

function useTimeout(team) {
	let maxTO = (period <= 2) ? 2 : 3;
	let current = (team === 'home') ? toHome : toGuest;
	current--;
	if (current < 0) current = maxTO;
	if (team === 'home') toHome = current;
	else toGuest = current;
	renderDotsWithCapacity(team + '-to', current, maxTO, 'green-on');
}

function setPeriod(num) {
	document.getElementById(`p${period}`).classList.remove('p-active');
	period = num;
	document.getElementById(`p${period}`).classList.add('p-active');
	foulsHome = 0; foulsGuest = 0;
	renderDots('home-tf', 0, 5, 'red-on');
	renderDots('guest-tf', 0, 5, 'red-on');
	document.getElementById('bonus-home').classList.remove('bonus-active');
	document.getElementById('bonus-guest').classList.remove('bonus-active');
	let maxTO = (period <= 2) ? 2 : 3;
	toHome = maxTO; toGuest = maxTO;
	renderDotsWithCapacity('home-to', toHome, maxTO, 'green-on');
	renderDotsWithCapacity('guest-to', toGuest, maxTO, 'green-on');
}

function renderDots(id, activeCount, total, activeClass) {
	const container = document.getElementById(id);
	const dots = container.getElementsByClassName('dot');
	for (let d of dots) {
		d.style.display = 'inline-block';
		d.classList.remove('red-on', 'green-on');
	}
	for (let i = 0; i < activeCount; i++) if (i < total) dots[i].classList.add(activeClass);
}

function renderDotsWithCapacity(id, activeCount, capacity, activeClass) {
	const container = document.getElementById(id);
	const dots = container.getElementsByClassName('dot');
	for (let i = 0; i < 5; i++) {
		if (i < capacity) {
			dots[i].style.display = 'inline-block';
			dots[i].classList.remove(activeClass);
			if (i < activeCount) dots[i].classList.add(activeClass);
		} else dots[i].style.display = 'none';
	}
}

function togglePos() {
	const leftArrow = document.getElementById('pos-left');
	const rightArrow = document.getElementById('pos-right');
	posLeft = !posLeft;
	if (posLeft) {
		leftArrow.classList.add('active');
		rightArrow.classList.remove('active');
	} else {
		leftArrow.classList.remove('active');
		rightArrow.classList.add('active');
	}
}

// Initialize Logic
setPeriod(1);
</script>
